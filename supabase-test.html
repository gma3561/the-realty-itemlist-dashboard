<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase ì—°ê²° í…ŒìŠ¤íŠ¸ | The Realty</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .success { border-left: 5px solid #28a745; }
        .error { border-left: 5px solid #dc3545; }
        .info { border-left: 5px solid #17a2b8; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .loading { opacity: 0.6; pointer-events: none; }
        pre { background: #f1f3f4; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>ğŸ  Supabase ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
    
    <div class="card info">
        <h3>ğŸ“ ì—°ê²° ì •ë³´</h3>
        <p><strong>Supabase URL:</strong> https://aekgsysvipnwxhwixglg.supabase.co</p>
        <p><strong>API Key:</strong> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</p>
    </div>

    <div class="card">
        <h3>ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h3>
        <button onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <button onclick="testTables()">í…Œì´ë¸” êµ¬ì¡° í™•ì¸</button>
        <button onclick="testProperties()">ë§¤ë¬¼ ë°ì´í„° ì¡°íšŒ</button>
        <button onclick="testInsert()">í…ŒìŠ¤íŠ¸ ë§¤ë¬¼ ë“±ë¡</button>
    </div>

    <div id="results"></div>

    <script>
        const SUPABASE_URL = 'https://aekgsysvipnwxhwixglg.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFla2dzeXN2aXBud3hod2l4Z2xnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc3NjI0MTgsImV4cCI6MjA1MzMzODQxOH0.z7C6bXL0Y6kCJEPIu6AlKLGi1vgfwdD9QQ0rtjcqe5g';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        function addResult(title, content, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `card ${type}`;
            div.innerHTML = `
                <h3>${title}</h3>
                <pre>${JSON.stringify(content, null, 2)}</pre>
            `;
            results.appendChild(div);
        }

        async function testConnection() {
            try {
                addResult('ğŸ”„ ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...', 'ì—°ê²°ì„ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                
                const { data, error } = await supabase
                    .from('properties')
                    .select('count')
                    .limit(1);

                if (error) throw error;
                
                addResult('âœ… ì—°ê²° ì„±ê³µ', {
                    message: 'Supabase ì—°ê²°ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤',
                    timestamp: new Date().toISOString()
                }, 'success');
            } catch (error) {
                addResult('âŒ ì—°ê²° ì‹¤íŒ¨', {
                    error: error.message,
                    timestamp: new Date().toISOString()
                }, 'error');
            }
        }

        async function testTables() {
            try {
                addResult('ğŸ”„ í…Œì´ë¸” êµ¬ì¡° í™•ì¸ ì¤‘...', 'í…Œì´ë¸”ì„ ì¡°íšŒí•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                
                const tables = ['properties', 'property_types', 'transaction_types', 'property_statuses', 'users'];
                const results = {};

                for (const table of tables) {
                    try {
                        const { data, error } = await supabase
                            .from(table)
                            .select('*')
                            .limit(1);

                        results[table] = {
                            exists: true,
                            error: error?.message || null,
                            sampleCount: data?.length || 0
                        };
                    } catch (err) {
                        results[table] = {
                            exists: false,
                            error: err.message
                        };
                    }
                }
                
                addResult('ğŸ“Š í…Œì´ë¸” êµ¬ì¡°', results, 'info');
            } catch (error) {
                addResult('âŒ í…Œì´ë¸” í™•ì¸ ì‹¤íŒ¨', {
                    error: error.message
                }, 'error');
            }
        }

        async function testProperties() {
            try {
                addResult('ğŸ”„ ë§¤ë¬¼ ë°ì´í„° ì¡°íšŒ ì¤‘...', 'ë§¤ë¬¼ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                
                const { data, error } = await supabase
                    .from('properties')
                    .select('*')
                    .limit(5);

                if (error) throw error;
                
                addResult('ğŸ  ë§¤ë¬¼ ë°ì´í„°', {
                    count: data.length,
                    properties: data.map(p => ({
                        id: p.id,
                        property_name: p.property_name,
                        location: p.location,
                        created_at: p.created_at
                    }))
                }, 'success');
            } catch (error) {
                addResult('âŒ ë§¤ë¬¼ ì¡°íšŒ ì‹¤íŒ¨', {
                    error: error.message
                }, 'error');
            }
        }

        async function testInsert() {
            try {
                addResult('ğŸ”„ í…ŒìŠ¤íŠ¸ ë§¤ë¬¼ ë“±ë¡ ì¤‘...', 'í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                
                const testProperty = {
                    property_name: 'í…ŒìŠ¤íŠ¸ ë§¤ë¬¼',
                    location: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…ŒìŠ¤íŠ¸ë™',
                    property_type: 'apt',
                    transaction_type: 'sale',
                    property_status: 'available',
                    price: 50000,
                    manager_id: 'test-user',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                };

                const { data, error } = await supabase
                    .from('properties')
                    .insert([testProperty])
                    .select();

                if (error) throw error;
                
                addResult('âœ… ë§¤ë¬¼ ë“±ë¡ ì„±ê³µ', {
                    message: 'í…ŒìŠ¤íŠ¸ ë§¤ë¬¼ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤',
                    data: data[0]
                }, 'success');
            } catch (error) {
                addResult('âŒ ë§¤ë¬¼ ë“±ë¡ ì‹¤íŒ¨', {
                    error: error.message,
                    details: error
                }, 'error');
            }
        }
    </script>
</body>
</html>