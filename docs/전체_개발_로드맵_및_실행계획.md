# 전체 개발 로드맵 및 실행 계획

## 1. 프로젝트 현황 요약
- **기획-개발 일치도**: 97%
- **핵심 기능 구현율**: 100%
- **UI/UX 평가 점수**: 82.5/100
- **보안 준비도**: 85% (QA용 바이패스 유지)

## 2. 단계별 실행 계획

### Phase 1: 테스트 기반 구축 (1주차)

#### 1.1 테스트 시나리오 작성
- **E2E 테스트 시나리오**
  - [ ] 로그인 플로우 (Google OAuth + 바이패스)
  - [ ] 매물 CRUD 사이클
  - [ ] 권한 기반 접근 제어
  - [ ] 고객 정보 보안 검증
  - [ ] 모바일 반응형 테스트

- **단위 테스트 계획**
  - [ ] 인증 컨텍스트 테스트
  - [ ] 권한 유틸리티 테스트
  - [ ] 데이터 변환 함수 테스트

- **통합 테스트**
  - [ ] Supabase 연동 테스트
  - [ ] 이미지 업로드 플로우
  - [ ] 실시간 데이터 동기화

#### 1.2 테스트 인프라 구축
```bash
# 필요한 패키지 설치
npm install --save-dev @testing-library/react @testing-library/jest-dom
npm install --save-dev @playwright/test
npm install --save-dev vitest @vitest/ui
```

### Phase 2: 프로덕션 준비 (2주차)

#### 2.1 보안 강화 (바이패스 유지)
- **환경변수 분리**
  ```javascript
  // 개발/QA 환경
  VITE_ENABLE_BYPASS=true
  VITE_BYPASS_USERS=["admin@test.com", "user@test.com"]
  
  // 프로덕션 환경
  VITE_ENABLE_BYPASS=false
  ```

- **조건부 바이패스 구현**
  - [ ] 환경변수 기반 바이패스 토글
  - [ ] QA 모드 표시 UI
  - [ ] 바이패스 사용 로깅

#### 2.2 환경 설정 정리
- **환경별 설정 파일**
  - [ ] `.env.development` - 개발 환경
  - [ ] `.env.qa` - QA 환경
  - [ ] `.env.production` - 프로덕션 환경
  - [ ] `.env.example` - 템플릿

- **빌드 스크립트 개선**
  ```json
  {
    "scripts": {
      "dev": "vite --mode development",
      "build:qa": "vite build --mode qa",
      "build:prod": "vite build --mode production",
      "preview": "vite preview"
    }
  }
  ```

### Phase 3: 성능 최적화 (3주차)

#### 3.1 번들 크기 최적화
- **코드 스플리팅**
  - [ ] 라우트 기반 lazy loading
  - [ ] 컴포넌트 동적 import
  - [ ] 차트 라이브러리 분리

- **이미지 최적화**
  - [ ] WebP 포맷 지원
  - [ ] 이미지 lazy loading
  - [ ] 썸네일 생성 로직

#### 3.2 로딩 속도 개선
- **캐싱 전략**
  - [ ] Service Worker 구현
  - [ ] API 응답 캐싱
  - [ ] 정적 자산 캐싱

- **렌더링 최적화**
  - [ ] React.memo 적용
  - [ ] useMemo/useCallback 최적화
  - [ ] 가상 스크롤링 구현

### Phase 4: 문서화 (4주차)

#### 4.1 개발자 가이드
- **프로젝트 구조 문서**
  - [ ] 폴더 구조 설명
  - [ ] 아키텍처 다이어그램
  - [ ] 데이터 플로우 차트

- **컴포넌트 문서**
  - [ ] 주요 컴포넌트 API
  - [ ] Props 타입 정의
  - [ ] 사용 예제

#### 4.2 API 문서
- **Supabase 스키마**
  - [ ] 테이블 구조 문서화
  - [ ] RLS 정책 설명
  - [ ] 함수/트리거 문서

- **프론트엔드 서비스**
  - [ ] 서비스 레이어 API
  - [ ] 에러 처리 가이드
  - [ ] 인증 플로우 다이어그램

### Phase 5: 추가 기능 개발 (5-6주차)

#### 5.1 다크 모드 구현
- **CSS 변수 확장**
  ```css
  :root[data-theme="dark"] {
    --bg-primary: #1a1a1a;
    --text-primary: #ffffff;
    /* ... */
  }
  ```

- **테마 토글 구현**
  - [ ] 테마 컨텍스트 생성
  - [ ] 토글 버튼 UI
  - [ ] 시스템 설정 연동

#### 5.2 고급 기능
- **알림 시스템**
  - [ ] 실시간 알림 구현
  - [ ] 알림 설정 페이지
  - [ ] 푸시 알림 지원

- **데이터 내보내기**
  - [ ] Excel 내보내기
  - [ ] PDF 리포트 생성
  - [ ] 일괄 다운로드

## 3. 기술적 구현 세부사항

### 3.1 테스트 시나리오 구현

#### E2E 테스트 예시
```javascript
// tests/e2e/auth.spec.js
import { test, expect } from '@playwright/test';

test.describe('인증 플로우', () => {
  test('Google 로그인 성공', async ({ page }) => {
    await page.goto('/login');
    await page.click('button:has-text("Google로 로그인")');
    // OAuth 플로우 검증
  });

  test('바이패스 로그인 (QA 전용)', async ({ page }) => {
    await page.goto('/login');
    await page.click('button:has-text("관리자로 로그인")');
    await expect(page).toHaveURL('/');
    await expect(page.locator('[data-testid="user-role"]')).toContainText('관리자');
  });
});
```

### 3.2 조건부 바이패스 구현

```javascript
// src/context/AuthContext.jsx 수정
const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const isQAMode = import.meta.env.VITE_ENABLE_BYPASS === 'true';

  const checkUser = async (skipLoading = false) => {
    try {
      if (!skipLoading) setLoading(true);
      
      // QA 모드에서만 바이패스 확인
      if (isQAMode) {
        const tempBypassUser = localStorage.getItem('temp-bypass-user');
        if (tempBypassUser) {
          const bypassUser = JSON.parse(tempBypassUser);
          setUser(bypassUser);
          setError(null);
          setLoading(false);
          return;
        }
      }
      
      // 정상적인 Supabase 인증 플로우
      // ...
    } catch (error) {
      // ...
    }
  };

  // QA 모드 표시 컴포넌트
  const QAModeBanner = () => {
    if (!isQAMode) return null;
    
    return (
      <div className="fixed top-0 left-0 right-0 bg-yellow-500 text-black text-center py-1 z-50">
        <span className="text-sm font-medium">QA 테스트 모드 활성화</span>
      </div>
    );
  };

  return (
    <AuthContext.Provider value={value}>
      <QAModeBanner />
      {children}
    </AuthContext.Provider>
  );
};
```

### 3.3 성능 모니터링 구현

```javascript
// src/utils/performance.js
export const measurePerformance = {
  // 페이지 로드 시간 측정
  pageLoad: () => {
    if (typeof window !== 'undefined' && window.performance) {
      const perfData = window.performance.timing;
      const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
      console.log(`Page Load Time: ${pageLoadTime}ms`);
      
      // 분석 서비스로 전송
      if (window.gtag) {
        window.gtag('event', 'timing_complete', {
          name: 'load',
          value: pageLoadTime,
        });
      }
    }
  },

  // API 응답 시간 측정
  apiCall: async (name, fn) => {
    const start = performance.now();
    try {
      const result = await fn();
      const duration = performance.now() - start;
      console.log(`API Call "${name}": ${duration}ms`);
      return result;
    } catch (error) {
      const duration = performance.now() - start;
      console.error(`API Call "${name}" failed: ${duration}ms`, error);
      throw error;
    }
  }
};
```

## 4. 주요 마일스톤 및 체크포인트

### 마일스톤 1: 테스트 커버리지 80% 달성
- **기한**: 1주차 완료
- **검증 항목**:
  - [ ] 핵심 기능 E2E 테스트 작성
  - [ ] 단위 테스트 커버리지 측정
  - [ ] CI/CD 파이프라인 통합

### 마일스톤 2: QA 환경 구축 완료
- **기한**: 2주차 완료
- **검증 항목**:
  - [ ] QA 전용 환경 배포
  - [ ] 바이패스 기능 조건부 활성화
  - [ ] 환경별 설정 분리 완료

### 마일스톤 3: 성능 목표 달성
- **기한**: 3주차 완료
- **목표 지표**:
  - [ ] 초기 로드 시간 < 3초
  - [ ] 번들 크기 < 500KB
  - [ ] Lighthouse 점수 > 90

### 마일스톤 4: 문서화 100% 완료
- **기한**: 4주차 완료
- **산출물**:
  - [ ] README.md 업데이트
  - [ ] API 문서 (Swagger/OpenAPI)
  - [ ] 컴포넌트 스토리북

### 마일스톤 5: 프로덕션 준비 완료
- **기한**: 6주차 완료
- **체크리스트**:
  - [ ] 모든 테스트 통과
  - [ ] 보안 점검 완료
  - [ ] 성능 목표 달성
  - [ ] 문서화 완료
  - [ ] 롤백 계획 수립

## 5. 리스크 관리

### 기술적 리스크
1. **Supabase 제한사항**
   - 대응: 사용량 모니터링, 캐싱 전략
   
2. **번들 크기 증가**
   - 대응: 코드 스플리팅, Tree shaking

3. **브라우저 호환성**
   - 대응: Polyfill, 점진적 향상

### 일정 리스크
1. **테스트 작성 지연**
   - 대응: 핵심 기능 우선 테스트

2. **문서화 부족**
   - 대응: 코드 내 주석 강화

## 6. 성공 지표

### 정량적 지표
- 테스트 커버리지 ≥ 80%
- 페이지 로드 시간 < 3초
- Lighthouse 점수 ≥ 90
- 번들 크기 < 500KB

### 정성적 지표
- 개발자 온보딩 시간 단축
- QA 팀 피드백 긍정적
- 사용자 만족도 향상

## 7. 다음 단계

1. **즉시 시작**: Phase 1 - 테스트 시나리오 작성
2. **우선순위**: E2E 테스트 > 단위 테스트 > 통합 테스트
3. **병렬 진행**: 문서화는 개발과 동시 진행